# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ YAML –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É –∏ –¥–∞—à–±–æ—Ä–¥–∞–º Grafana

## üéØ –û–±–∑–æ—Ä

YAML –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç—á–µ—Ç—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ PostgreSQL –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ Grafana. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ —Ö–æ—Å—Ç–∞–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (PostgreSQL, Redis, Grafana, YAML –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä)
cd analyzer
docker-compose -f grafana/docker-compose.grafana.yml up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose -f grafana/docker-compose.grafana.yml ps
```

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è YAML –æ—Ç—á–µ—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º
python3 src/glacier.py --no-s3

# –†–µ–∑—É–ª—å—Ç–∞—Ç: MacBook-Pro-Mihail.local_darwin_report_analyzer.yaml
```

### 3. –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–∞

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ YAML —Ñ–∞–π–ª–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
docker cp MacBook-Pro-Mihail.local_darwin_report_analyzer.yaml analyzer-yaml-processor:/app/reports/

# –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç—Å—è –∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—Å—è –≤ /data/processed/
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
grafana/
‚îú‚îÄ‚îÄ docker-compose.grafana.yml          # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª Docker Compose
‚îú‚îÄ‚îÄ grafana/
‚îÇ   ‚îú‚îÄ‚îÄ dashboards/                     # –î–∞—à–±–æ—Ä–¥—ã Grafana
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analyzer-overview.json      # –û–±–∑–æ—Ä–Ω—ã–π –¥–∞—à–±–æ—Ä–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ advanced-network-dashboard.json  # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Å–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security-analysis-dashboard.json # –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ provisioning/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Grafana
‚îÇ       ‚îú‚îÄ‚îÄ dashboards/dashboards.yml   # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∞—à–±–æ—Ä–¥–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ datasources/datasources.yml # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ yaml-processor/
‚îÇ   ‚îú‚îÄ‚îÄ yaml_processor.py              # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile                     # –û–±—Ä–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ uploads/                       # –ü–∞–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ processed/                     # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îî‚îÄ‚îÄ database/
    ‚îî‚îÄ‚îÄ init/                          # SQL —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç YAML –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–ø–∫–∏**: –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä —Å–ª–µ–¥–∏—Ç –∑–∞ –ø–∞–ø–∫–æ–π `/app/reports/` –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
2. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**: –ò—â–µ—Ç —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.yaml` –∏ `.yml`
3. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –ü–∞—Ä—Å–∏—Ç NetFlow –¥–∞–Ω–Ω—ã–µ –∏ —Å–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
4. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ hostname**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç hostname –∏–∑:
   - `system_information.hostname`
   - `host_info.hostname`
   - `meta.host_info.hostname`
   - –ò–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ (fallback)
5. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ë–î**: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ PostgreSQL
6. **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ `/data/processed/`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä —Å–æ–∑–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:

- **connections** - –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **protocol_stats** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º
- **top_destinations** - –¢–æ–ø –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
- **process_stats** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- **system_metrics** - –û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã

## üìä –î–∞—à–±–æ—Ä–¥—ã Grafana

-### 1. Glacier Overview Dashboard
- **URL**: http://localhost:3000/d/glacier-overview
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–ü–∞–Ω–µ–ª–∏**: –ì—Ä–∞—Ñ–∏–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### 2. Advanced Network Dashboard  
- **URL**: http://localhost:3000/d/advanced_network_dashboard
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- **–ü–∞–Ω–µ–ª–∏**:
  - üåê –¢—Ä–∞—Ñ–∏–∫ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º
  - üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
  - üîó –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
  - üåç –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ö–æ—Å—Ç—ã
  - ‚öôÔ∏è –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
  - üìà –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
  - üéØ –¢–æ–ø –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
  - üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
  - üïê –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 3. Security Analysis Dashboard
- **URL**: http://localhost:3000/d/security_soc_dashboard  
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑
- **–ü–∞–Ω–µ–ª–∏**:
  - üö® ICMP —Ñ–ª—É–¥—ã
  - üïµÔ∏è –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP
  - üîí –ü–æ–ø—ã—Ç–∫–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
  - üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
  - üì§ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
  - ‚ö†Ô∏è –ù–µ–æ–±—ã—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–æ–≤
  - üö® –í—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
  - üìà –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ —É–≥—Ä–æ–∑

## üè∑Ô∏è –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ö–æ—Å—Ç–∞–º

### –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è Hostname

–í—Å–µ –¥–∞—à–±–æ—Ä–¥—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ hostname:

1. **–í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫**: –í –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞
2. **–û–ø—Ü–∏–∏**:
   - `All` - –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Ö–æ—Å—Ç–æ–≤
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π hostname (–Ω–∞–ø—Ä–∏–º–µ—Ä, `MacBook-Pro-Mihail.local`)
3. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –°–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π –¥–∞—à–±–æ—Ä–¥
2. –í –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –Ω–∞–π–¥–∏—Ç–µ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ "Hostname"
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ö–æ—Å—Ç –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ "All"
4. –í—Å–µ –ø–∞–Ω–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞–º–∏

### –°–ø–æ—Å–æ–±—ã –∑–∞–≥—Ä—É–∑–∫–∏

#### 1. –ü—Ä—è–º–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker cp report.yaml analyzer-yaml-processor:/app/reports/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
docker logs analyzer-yaml-processor --tail 10
```

#### 2. –ß–µ—Ä–µ–∑ volume (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–∞–ø–∫—É
cp report.yaml grafana/data/uploads/
```

#### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞
```bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
#!/bin/bash
echo "üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞..."
python3 src/glacier.py --no-s3

echo "üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä..."
docker cp MacBook-Pro-Mihail.local_darwin_report_analyzer.yaml analyzer-yaml-processor:/app/reports/

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—à–±–æ—Ä–¥—ã —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥"
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
docker logs analyzer-yaml-processor -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
docker exec analyzer-yaml-processor ls -la /data/processed/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
docker exec analyzer-postgres psql -U analyzer_user -d analyzer_metrics -c "SELECT hostname, COUNT(*) FROM connections GROUP BY hostname;"
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∞–π–ª –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã**: –§–∞–π–ª –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –ø–∞–ø–∫–µ `/app/reports/`

**–†–µ—à–µ–Ω–∏—è**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs analyzer-yaml-processor`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –∏–º–µ–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `.yaml` –∏–ª–∏ `.yml`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç YAML: `python3 -c "import yaml; yaml.safe_load(open('file.yaml'))"`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

### –ü—Ä–æ–±–ª–µ–º–∞: Hostname –Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã**: –í –ë–î hostname = "unknown"

**–†–µ—à–µ–Ω–∏—è**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É YAML —Ñ–∞–π–ª–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å —Å–µ–∫—Ü–∏—è `system_information.hostname`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ò–∑–≤–ª–µ—á–µ–Ω hostname"

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞—à–±–æ—Ä–¥—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ

**–°–∏–º–ø—Ç–æ–º—ã**: –ü—É—Å—Ç—ã–µ –ø–∞–Ω–µ–ª–∏ –≤ Grafana

**–†–µ—à–µ–Ω–∏—è**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "Last 30 minutes")
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π hostname
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
4. –ù–∞–∂–º–∏—Ç–µ "Run query" –≤ –ø–∞–Ω–µ–ª–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è hostname –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã**: –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π

**–†–µ—à–µ–Ω–∏—è**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É –¥–∞–Ω–Ω—ã—Ö
2. –û–±–Ω–æ–≤–∏—Ç–µ –¥–∞—à–±–æ—Ä–¥: `python3 grafana/update-dashboards-hostname.py`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Grafana

## üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

```python
# –í yaml_processor.py –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
WATCH_INTERVAL = 10  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–π–ª–æ–≤ (—Å–µ–∫—É–Ω–¥—ã)
MAX_BATCH_SIZE = 1000  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–ª—è –ë–î
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Grafana

```yaml
# –í docker-compose.grafana.yml:
environment:
  - GF_DATABASE_MAX_OPEN_CONN=20
  - GF_DATABASE_MAX_IDLE_CONN=10
```

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```sql
-- –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
DELETE FROM connections WHERE time < NOW() - INTERVAL '30 days';
DELETE FROM protocol_stats WHERE time < NOW() - INTERVAL '30 days';
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –î–æ—Å—Ç—É–ø –∫ Grafana
- **URL**: http://localhost:3000
- **–õ–æ–≥–∏–Ω**: admin
- **–ü–∞—Ä–æ–ª—å**: admin123

### –î–æ—Å—Ç—É–ø –∫ PostgreSQL
- **–•–æ—Å—Ç**: localhost:5432
- **–ë–∞–∑–∞**: analyzer_metrics
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: analyzer_user
- **–ü–∞—Ä–æ–ª—å**: analyzer_password

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ production
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è Grafana
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø –∫ PostgreSQL
4. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
docker-compose -f grafana/docker-compose.grafana.yml down
docker-compose -f grafana/docker-compose.grafana.yml up -d

# –ë—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö
docker exec analyzer-postgres pg_dump -U analyzer_user analyzer_metrics > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö  
docker exec -i analyzer-postgres psql -U analyzer_user analyzer_metrics < backup.sql

# –≠–∫—Å–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–æ–≤
./grafana/export-import-dashboards.sh export

# –ò–º–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–æ–≤
./grafana/export-import-dashboards.sh import
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose -f grafana/docker-compose.grafana.yml ps

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats analyzer-grafana analyzer-postgres analyzer-yaml-processor

# –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker exec analyzer-postgres psql -U analyzer_user -d analyzer_metrics -c "SELECT pg_size_pretty(pg_database_size('analyzer_metrics'));"
```

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Grafana –∏ PostgreSQL

---